
//import org.json.JSONObject;
//
//import java.io.InputStream;
//import java.io.OutputStream;
//import java.net.HttpURLConnection;
//import java.net.URL;
//import java.nio.charset.StandardCharsets;

//public class ConsultaAPI {
//
//    public String Consultar(String textoUsuario) {
//        String apiKey = "Kxad2wFuEQDeRvuEOSgI8uX6FT7TOYN8A7mcrCVn";
//
//        // Endpoint de la API de Cohere para generación de texto
//        String endpoint = "https://api.cohere.ai/v1/generate";
//
//        // Cuerpo de la solicitud JSON
//        String jsonInput = """
//                    {
//                        \"model\": \"command-xlarge\",
//                        \"prompt\": \"Identifica las emociones en este texto: '%s' Y da una recomendación para manejar esas emociones (maximo 150 caracteres y en español).\",
//                        \"max_tokens\": 101
//                    }
//                """.formatted(textoUsuario);
//
//        try {
//            // Configurar la conexión
//            URL url = new URL(endpoint);
//            HttpURLConnection connection = (HttpURLConnection) url.openConnection();
//            connection.setRequestMethod("POST");
//            connection.setRequestProperty("Authorization", "Bearer " + apiKey);
//            connection.setRequestProperty("Content-Type", "application/json");
//            connection.setDoOutput(true);
//
//            // Enviar el cuerpo de la solicitud
//            try (OutputStream os = connection.getOutputStream()) {
//                byte[] input = jsonInput.getBytes(StandardCharsets.UTF_8);
//                os.write(input, 0, input.length);
//            }
//
//            // Leer la respuesta
//            int status = connection.getResponseCode();
//            InputStream inputStream = (status >= 200 && status < 300)
//                    ? connection.getInputStream()
//                    : connection.getErrorStream();
//            String response;
//            try (InputStream is = inputStream) {
//                response = new String(is.readAllBytes(), StandardCharsets.UTF_8);
//            }
//
//            // Imprimir la respuesta completa para depuración
//            System.out.println("Respuesta de la API: " + response);
//
//            // Parsear la respuesta JSON con JSONObject
//            JSONObject jsonResponse = new JSONObject(response);
//
//            // Verificar si la respuesta contiene "generations"
//            if (jsonResponse.has("generations")) {
//                String generatedText = jsonResponse.getJSONArray("generations")
//                        .getJSONObject(0)
//                        .getString("text");
//                return "Respuesta generada:\n" + generatedText.replace(".", ".\n");
//            } else if (jsonResponse.has("error")) {
//                // Manejo de errores específicos de la API
//                return "Error de la API: " + jsonResponse.getString("error");
//            } else {
//                // Si la respuesta no contiene "generations" ni "error"
//                return "Respuesta inesperada de la API: " + response;
//            }
//
//        } catch (Exception e) {
//            e.printStackTrace();
//            return "Ocurrió un error al procesar el texto: " + e.getMessage();
//        }
//    }
//}

para recibir respuesta de la api

//            StringBuilder response = new StringBuilder();
//            try (InputStream is = inputStream) {
//                int ch;
//                while ((ch = is.read()) != -1) {
//                    response.append((char) ch);
//                }
//            }
